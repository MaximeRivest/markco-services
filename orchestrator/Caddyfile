{
    admin localhost:2019
}

markco.dev {
    # Published sites
    handle /@* {
        reverse_proxy localhost:3003
    }

    # Auth
    handle /auth/* {
        reverse_proxy localhost:3001
    }
    handle /join/* {
        reverse_proxy localhost:3001
    }

    # API & orchestrator
    handle /api/* {
        reverse_proxy localhost:3000
    }
    handle /login {
        reverse_proxy localhost:3000
    }
    handle /login/* {
        reverse_proxy localhost:3000
    }
    handle /sandbox {
        reverse_proxy localhost:3000
    }
    handle /logout {
        reverse_proxy localhost:3000
    }
    handle /dashboard {
        reverse_proxy localhost:3000
    }

    # Static assets (editor JS, sandbox shims, fonts, xterm)
    handle /static/* {
        root * /opt/markco/static
        file_server
    }

    # Default: orchestrator handles routing
    handle {
        reverse_proxy localhost:3000
    }
}
